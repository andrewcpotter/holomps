# from More_entanglement1 import fermi_hubbard_half_filling_more_entanglement1
# from More_entanglement import fermi_hubbard_half_filling_more_entanglement
# from fermi_hubbard_star_circuit_1 import fermi_hubbard_half_filling_star_circuit
from full_connected_JW import *
import numpy as np

params_better_list =  [ 2.89977469e-03,  4.37368595e+00,  1.67488759e+00,  2.41179109e+00,
1.79112246e+00,  1.42877499e+00,  6.45059054e+00,  3.32820068e+00,
5.69548955e-01,  5.19455117e+00,  5.86849004e+00,  2.00034579e+00,
4.73688607e+00,  2.29124960e+00,  4.33472716e+00,  6.59237083e+00,
1.25217904e+00,  9.15303435e-05,  2.64834389e+00,  7.88467547e-01,
1.94061518e+00, -8.82004277e-05,  2.66926228e+00,  1.26434502e+00,
4.15374330e+00,  2.92458448e+00,  6.85974251e+00, 3.40430679e+00,
3.89533881e+00,  2.75080654e+00,  2.42872308e-01, 4.36702604e+00,
6.52998696e-01,  6.14665172e+00,  5.74786248e+00,  6.28661618e+00,
5.07168348e+00,  1.77640739e+00,  5.85592574e-01,  4.99043047e+00,
6.74080263e+00,  6.55639040e+00,  5.14248656e-01,  2.37366324e+00,
4.10815935e+00,  3.79563637e+00,  8.30532648e-01,  7.15250346e-01,
2.38033039e+00,  2.23491994e+00,  4.54431228e+00,  5.12257121e-01,
5.62419008e+00,  3.82607591e+00,  5.69036473e+00,  6.00236820e+00,
3.59164223e+00,  3.58969428e+00,  6.26818607e+00,  8.89159843e-01,
6.70900865e-01,  9.85771017e-01,  5.90057967e+00,  5.36972685e+00,
5.73519644e+00,  2.38234205e+00,  2.85778393e+00,  4.72403502e+00,
2.07344471e+00,  7.76093682e-01, 2.75343752e+00, 4.05103103e+00,
1.53992619e+00,  2.70729808e+00,  1.08389933e+00,  5.66177648e+00,
1.06339136e+00,  1.16727873e-01,  2.58691372e+00,  4.42876843e+00,
5.43984939e+00,  3.06650730e+00,  3.05603133e+00,  4.36844971e+00,
7.85596447e+00,  4.54522549e+00,  6.39065173e+00,  2.15842385e+00,
5.44935216e+00,  5.54805055e+00, -3.19414619e-02,  1.25535561e+00,
2.48841344e+00,  3.44666692e+00,  5.69513909e+00,  2.32262929e+00,
1.62926005e+00,  2.41563452e+00,  6.09247297e+00,  3.04330850e+00,
4.05708103e+00,  1.44310466e+00,  4.16763499e-01,  2.62163614e+00,
3.90508157e+00,  2.37629884e-03,  2.26330772e+00,  3.15314223e-01,
3.90475485e+00,  4.46943921e+00,  3.61811274e+00,  7.69215612e-01,
5.21048948e+00,  8.85526207e-01,  3.85953841e+00,  6.26793457e+00,
2.13414991e+00,  6.43828110e+00]

params_better = np.array(params_better_list)
#(E1, filling_gs, sweet_spot) = fermi_hubbard_half_filling_more_entanglement(1, 8, 0, True, 0, 100, 20, False, 1)

(E1, filling_gs, sweet_spot) = fermi_hubbard_half_filling_fully_connected(1,8,0,True,100,10, True, params_better)
print(E1, filling_gs)
E0 = E1 - 1
iter = 1
while abs(E0-E1) > 1e-6:
    E0 = E1
    params_better = sweet_spot
    (E1, filling_gs, sweet_spot) = fermi_hubbard_half_filling_fully_connected(1,8,0,True,100,10, True, params_better)
    iter = iter + 1
    print(E1, filling_gs)
print(sweet_spot)
print(iter)